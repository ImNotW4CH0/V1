if not game:IsLoaded() then 
    print("[AntiAdmin] Game not loaded, waiting...")
    game.Loaded:Wait() 
end
task.wait(1)

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local HttpService = game:GetService("HttpService")

local blacklist = {
    ["BlueThikFish"] = true,
    ["0CUH"] = true,
    ["3_Dak"] = true,
    ["Helyras"] = true,
    ["shedowv"] = true,
    ["Vlncain"] = true,
    ["chichine"] = true,
    ["Florianne10"] = true
}

local kicked = false

local function scheduleRejoin()
    getgenv().kicktime = os.time()
    getgenv().placeid = game.PlaceId
    getgenv().jobid = game.JobId
    print("[AntiAdmin] Scheduled rejoin:", getgenv().placeid, getgenv().jobid)
end

local function setWaitTime(playerName)
    if playerName == "0CUH" or playerName == "shedowv" then
        getgenv().waitTime = math.random(600, 900)
    elseif playerName == "BlueThikFish" then
        getgenv().waitTime = math.random(600, 650)
	--past 3600, 7200
	--past 10800, 14400
    elseif playerName == "3_Dak" then
        getgenv().waitTime = math.random(3600, 5400)
    end
end

for _, player in ipairs(Players:GetPlayers()) do
    if not kicked and blacklist[player.Name] then
        print("[AntiAdmin] Blacklisted player found:", player.Name)

        local isReportable = (player.Name == "BlueThikFish" or player.Name == "3_Dak" or player.Name == "0CUH" or player.Name == "shedowv") and game.PlaceId ~= 12568963478

        if isReportable then
            pcall(function()
                game:HttpGet("http://192.168.1.2:5000/botwarning")
            end)
            setWaitTime(player.Name)
        end

        scheduleRejoin()
        print("[AntiAdmin] Kicking local player due to blacklist")

        local kickReason = isReportable
            and ("ModCheck I // REPORTING: " .. player.Name)
            or  ("ModCheck I // SAFE: " .. player.Name)

        LocalPlayer:Kick(kickReason)
        kicked = true
        break
    end
end

Players.PlayerAdded:Connect(function(player)
    if not kicked and blacklist[player.Name] then
        print("[AntiAdmin] Blacklisted player joined:", player.Name)

        local isReportable = (player.Name == "BlueThikFish" or player.Name == "3_Dak" or player.Name == "0CUH" or player.Name == "shedowv") and game.PlaceId ~= 12568963478

        if isReportable then
            pcall(function()
                game:HttpGet("http://192.168.1.2:5000/botwarning")
            end)
            setWaitTime(player.Name)
        end

        scheduleRejoin()
        print("[AntiAdmin] Kicking local player due to new blacklisted join")

        local kickReason = isReportable
            and ("ModCheck II // REPORTING: " .. player.Name)
            or  ("ModCheck II // SAFE: " .. player.Name)

        LocalPlayer:Kick(kickReason)
        kicked = true
    end
end)

while task.wait(1) do
    if kicked then
        break
    end

    local success, result = pcall(function()
        return game:HttpGet("http://192.168.1.2:5000/risk")
    end)

    if success and result == "DANGER" and game.PlaceId ~= 12568963478 and game.PlaceId ~= 16092814784 then
        scheduleRejoin()
        print("[AntiAdmin] Kicking local player due to global risk")
        LocalPlayer:Kick("ModCheck // GLOBAL")
        kicked = true
        break
    elseif not success then
        warn("[AntiAdmin] Risk check failed:", result)
    end
end
